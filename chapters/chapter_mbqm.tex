The Schr\"{o}dinger equation only offers exact solutions
for very small and simple systems, such as the hydrogen atom
or a system of non-interacting harmonic oscillators.
If we want to study most systems of interest we must turn
instead to numerical methods and solutions.
The most prominent methods in the field of manybody
quantum mechanics are the Hartree-Fock (HF) and the
Density Functional Theory families of solvers.
This chapter will give a brief overview of both methods,
focused more on understanding and intuition than rigor.
Eventually we will take these methods to be black boxes of
electronic structure calculations, given some cartesian
coordinates and outputting energies and forces.
\par
This section will give a brief overview of the discussion
of the electronic Hamiltonian in \parencite[Szabo][pages 39-89]
{szabo1996modern}, which also covers Hartree-Fock theory
which will be expanded upon in the next section.
We want to find solutions to the non-relativistic time-independent
Schr\"{o}dinger equation:

$$ \hat{H} \ket{\Psi} = E \ket{\Psi} ,$$

with the Hamiltonian $\hat{H}$ describing a system of nuclei and electrons
with cartesian coordinates $\bm{R}_a, \ a=1,2,\dots,A$ and $\bm{r}_i, \
i=1,2,\dots,N$ respectively. The distance between nuclei $a$
and electron $i$ is given as the euclidean distance
$R_{ai} = \left| \bm{R}_a - \bm{r}_i \right|$
and correspondingly for the nuclei-nuclei and electron-electron distances.
The full Hamiltonian for a set of $N$ electrons and $A$ nuclei
in atomic units is:

\begin{equation}
    \begin{split}
        \hat{H}
        &= -\sum_{i=1}^N \frac{1}{2} \nabla_i^2
        -\sum_{a=1}^A \frac{1}{M_a} \nabla_a^2
        -\sum_{i=1}^N \sum_{a=1}^A \frac{Z_a}{R_{ia}} \\
        &+ \sum_{i=1}^N \sum_{j=i+1}^N \frac{1}{r_{ij}}
        + \sum_{a=1}^A \sum_{b=a+1}^A \frac{Z_a Z_b}{R_{ab}}
    \end{split} .
\end{equation}

The first two terms describe the kinetic energy operators
of the electrons and nuclei, with $M_a$ the ratio of the mass
of nuclei $a$ to the electron mass. The third term describes the
coulomb attraction between electrons and nuclei, while the fourth and fifth
terms describe the repulsion between electrons and nuclei respectively.
\par
Since the nuclei are approximately 2000 times heavier
than the electrons, the electrons can to a good approximation
be described as moving in the field of fixed nuclei. In practice we
neglect the kinetic energy terms of the nuclei, while considering
an averaged effect from the nuclei-nuclei repulsion.
The nuclei-nuclei repulsion energy averaged over 
adds a constant to the energy
eigenvalues, but has no effect on the energy eigenfunctions.
The remaining terms are known as the electronic Hamiltonian:

\begin{equation}
    \hat{H}_e = -\sum_{i=1}^N \frac{1}{2} \nabla_i^2
    -\sum_{i=1}^N \sum_{a=1}^A \frac{Z_A}{R_{ia}}
    +\sum_{i=1}^N \sum_{j=i+1}^N \frac{1}{r_{ij}} .
\end{equation}

The electronic wavefunction $\Psi_e = \Psi_e(\{r_i\}; \{R_a\})$
is a function of the electronic coordinates with a parametric dependence
on the fixed nucleic coordinates. The electronic energy
is obtained in the usual way $E_{e} = \braket{\Psi_e | \hat{H}_e |
\Psi_e} $. The total energy of our system
must now include the constant nuclear repulsion:

$$ E_{tot} = E_{e} + \sum_{a=1}^A \sum_{b=a+1}^A
    \frac{Z_a Z_b}{R_{ab}} . $$

If one has solved the Schr\"{o}dinger equation for the electronic
Hamiltonian, one can subsequently solve for the nucleic motion
using the same trick, i.e. substituting the electronic coordinates
for their average values, averaged over the electronic wave function.
We are then left with a nuclear Hamiltonian $\hat{H}_n$:

\begin{equation}
    \begin{split}
        \hat{H}_n
        &= -\sum_{a=1}^A \frac{1}{2 M_a} \nabla_a^2
        + \biggl< -\sum_{i=1}^N \frac{1}{2} \nabla_i^2
        - \sum_{i=1}^N \sum_{a=1}^A \frac{Z_a}{R_{ia}}
        + \sum_{i=1}^N \sum_{j=i+1}^N \frac{1}{r_{ij}}
        \biggr> \\
        &+ \sum_{a=1}^A \sum_{b=a+1}^A
        \frac{Z_a Z_b}{R_{ab}} \\
        &= -\sum_{a=1}^A \frac{1}{2 M_a} \nabla_a^2
        + E_{tot} .
    \end{split}
\end{equation}

Under this approximation the nuclei move on a potential energy
surface obtained by solving the electronic Hamiltonian.
We will however remain focused on the electronic structure problem.
For the electronic Hamiltonian we would like to make one more
approximation.
The electronic Hamiltonian further simplifies if instead
of considering the relative positions of the nuclei,
we fix the coordinate system in the center of mass of the nucleus.
This gives us the final expression we want for the electronic
Hamiltonian:

\begin{equation}
    \hat{H} = -\sum_{i=1}^N \frac{1}{2} \nabla_i^2
    - \sum_{i=1}^N \frac{Z}{r_{i}} + \sum_{i=1}^N \sum_{j=i+1}^N
    \frac{1}{r_{ij}}
\end{equation}

\subsection{Hartree-Fock}
The Hartree-Fock method is a method for finding
solutions to the electronic Hamiltonian assuming
the electron-electron repulsion can be approximated
with a set of single-particle functions or \textit{orbitals},
moving in a mean field generated by the presence of other electrons.
The theory in this section is based upon the \parencite[Sherrill]
{sherrill2000} lecture notes from the Georgia Institute of Technology
and the lecture notes
on Computational Physics II \parencite[Hjorth-Jensen]
{hjensen2019} from the University of Oslo.
Assuming that the electrons do not interact
the Hamiltonian is separable and the wavefunction
is simply a product of orbitals $\psi$
which are solutions to a onebody Hamiltonian.
This gives us an ansatz for the manybody wavefunction $\Psi$
known as the \textit{Hartree product}:

$$ \Psi(\bm{r}_1,\dots,\bm{r}_N) = \psi(\bm{r}_1) \cdot \dots
    \cdot \psi(\bm{r}_N) . $$

Since we are dealing with fermions this ansatz fails to satisfy
the antisymmetry principle, i.e. the wavefunction
is not antisymmetric with respect to the interchange of any two
particles. Fermions in addition to three spatial degrees of freedom
also have a spin degree of freedom $\sigma$
which means the fermion can be described
by the space-spin coordinate $\bm{x} = (\bm{r}, \sigma)$
with $\bm{x} \in \mathbb{R}^3 \otimes \sigma$.
The problem of antisymmetry in a system of $N$ fermions
is satisfied by the introduction of \textit{Slater determinants}

\begin{equation}
\Psi(\bm{x}_1,\dots,\bm{x}_N)
= \frac{1}{\sqrt{N}}
\begin{vmatrix}
    \chi_{1}(\bm{x}_1) & \chi_{2}(\bm{x}_1)
    & \dots & \chi_{N}(\bm{x}_1) \\
    \chi_{1}(\bm{x}_2)  & \chi_{2}(\bm{x}_2)
    & \dots & \chi_{N}(\bm{x}_2) \\
    \vdots & \vdots & \ddots & \vdots \\
    \chi_{1}(\bm{x}_N) & \chi_{2}(\bm{x}_N)
    & \dots & \chi_{N}(\bm{x}_N)
\end{vmatrix} ,
\end{equation}

with $\chi(\bm{x})$ spin orbitals and a normalization factor
$(N!)^{-1/2}$. The introduction of this ansatz is equivalent to assuming that
all electrons move independently of each other
in a mean field generated by the electron-electron repulsion.
Define the one-electron operator of the electronic Hamiltonian as:

$$ \hat{h}_1(\bm{x}_i) = -\frac{1}{2} \nabla_i^2
    -\frac{Z}{r_i} , $$

with a twobody interaction term

$$ \hat{v}(\bm{x}_i, \bm{x}_j) = \frac{1}{r_{ij}} , $$

which allows us to write the electronic Hamiltonian more compactly as:

$$ \hat{H} = \sum_i \hat{h}_1(\bm{x}_i)
    + \sum_{i < j} \hat{v}(\bm{x}_i, \bm{x}_j) .$$

The expectation value of the energy is given as the usual inner product:

$$ \braket{\Psi | \hat{H} | \Psi} .$$

The \textit{variational theorem} states that the expectation
value of any normalized wavefunction with respect to the energy
represents an upper bound to the ground state energy.
This suggests a procedure wherein we vary the parameters
of a set of approximate wave functions $\Psi_T$
until an energy minimum is reached.
The Hartree-Fock energy can be written in terms of integrals
over the onebody and interaction terms:

$$ E_{HF} = \sum_i \braket{i | \hat{h} | i}
    + \sum_{i < j} \braket{ij | \hat{v} | ij}_{AS} ,$$

where we have introduced an antisymmetrized matrix element:

$$ \braket{ij | \hat{v} | ij}_{AS}
    = \braket{ij | \hat{v} | ij} - \braket{ij | \hat{v} | ji} , $$

and the shorthand integrals:

$$ \braket{i | \hat{h}_1 | i} =
    \int d\bm{r} \chi_i^*(\bm{r}) \hat{h}_1 \chi_i(\bm{r}) , $$

and

$$ \braket{ij | \hat{v} | ij} =
    \int d\bm{r}_i d\bm{r}_j \chi_i^*(\bm{r}_i) \chi_j^*(\bm{r}_j) 
    \hat{v} \chi_i(\bm{r}_i) \chi_j(\bm{r}_j) . $$

In order to derive the Hartree-Fock equations
we perform a linear expansion of the spin orbitals
$\chi$ in terms of a fixed orthogonal basis $\phi$:

$$ \chi_i = \sum_{\lambda} C_{i\lambda} \phi_{\lambda} , $$

in principle an infinite sum, but in practice truncated.
This basis is usually obtained as the eigenfunctions of
parts of the electronic Hamiltonian, e.g. solutions
to the Schr\"{o}dinger equation with a harmonic oscillator
or Coulomb potential.
If the coefficients belong to an orthogonal or unitary matrix,
the resulting basis will preserve orthogonality.
This expansion allows us to rewrite the Hartree-Fock energy as:

$$ E_{HF} = \sum_i \sum_{\alpha \beta}
    C_{i \alpha}^* C_{i\beta} \braket{\alpha | \hat{h}_1 | \beta}
    + \sum_{i < j} \sum_{\alpha \beta \delta \eta}
    C_{i\alpha}^* C_{j\beta}^* C_{i\delta} C_{j\eta}
    \braket{\alpha \beta | \hat{v} | \delta \eta} .$$

Using the method of Lagrangian multipliers
we can define a functional to be minimized:

\begin{equation}
\begin{split}
F[\Psi] &= E_{HF}[\Psi] - \sum_i \epsilon_i \braket{i | j} \\
        &= E_{HF}[\Psi] - \sum_i \epsilon_i \sum_{\alpha}
        C_{i\alpha}^* C_{i\alpha} ,
\end{split}
\end{equation}

with Lagrange multipliers $\epsilon_i$, where we have
exploited the orthogonality of the basis functions to
introduce the coefficients.
Minimizing with respect to $C_{i\alpha}^*$ yields
the equation:

\begin{equation}
\sum_{\beta} \left\{ \braket{\alpha | \hat{h}_1 | \beta} 
+ \sum_j^N \sum_{\delta \eta} C_{j\delta}^* C_{j\eta} 
\braket{\alpha \delta | \hat{v} | \beta \eta} \right\} 
C_{i\beta} = \epsilon_i C_{i\alpha}
\end{equation}

\subsection{Density functional theory}
Density functional theory is a method for
investigating the electronic structure of a manybody system
by finding approximations to the ground state
density $\rho(\bm{r})$. Our starting point
is again the electronic Hamiltonian

\begin{equation}
    \hat{H} = -\sum_{i=1}^N \frac{1}{2} \nabla_i^2
    - \sum_{i=1}^N \frac{Z}{r_{i}} + \sum_{i=1}^N \sum_{j=i+1}^N
    \frac{1}{r_{ij}} .
\end{equation}

Any electronic wavefunction $\Psi$ which solves this equation
is in principle a function of $4N$ coordinates $\bm{x}_i = (\bm{r}_i, \sigma_i)
, \ i=1,\dots,N$
where $N$ is the number of electrons.
Once we have obtained a solution to the Schr\"{o}dinger equation
we can obtain the one-electron density $\rho(\bm{r})$ as:

\begin{equation}
    \rho(\bm{r}) = \int \left| \Psi(\bm{r}, \sigma, \bm{x}_2,\dots,\bm{x}_N)
    \right|^2 d\sigma d\bm{x}_2 \dots d\bm{x}_N .
\end{equation}

Since the wavefunction is a unique functional of the Hamiltonian
$\hat{H}$, the one-electron density is uniquely determined
by the Hamiltonian. Hohenberg and Kohn showed in 1964 in their
first theorem that this mapping
can be inverted, i.e. that the one-electron density uniquely
determines the Hamiltonian of our system (up to an arbitrary constant).
Taken altogether, this means that all properties of our system, including
the Hamiltonian and the manybody wavefunction are fixed
by a one-electron density carrying a dependency on only 3 spatial coordinates.
\par
The electronic Hamiltonian can be rewritten as

$$ \hat{H} = \hat{F} + \hat{V}_{ne} , $$

where $\hat{F}$ is an operator consisting of the kinetic energy
and electron-electron operators and $\hat{V}_{ne}$
is the electron-nuclei interaction.
\par
For their second theorem, Hohenberg and Kohn defined
the universal density functional

$$ F[n] = \braket{\Psi[n] | \hat{F} | \Psi[n]} , $$

and the total electronic energy functional

$$ E[n] = F[n] + \int \hat{V}_{ne} n(\bm{r}) d\bm{r} . $$

Hohenberg and Kohn showed the energy functional
with respect to $N$-electron densitites $n(\bm{r})$
is an upper bound to the ground state energy:

$$ E_0 \leq F[n] + \int \hat{V}_{ne} n(\bm{r}) d\bm{r} , $$

with equality if and only if the one-electron density
is the one-electron density corresponding to our system $\hat{H}$.
This suggests a variational procedure, wherein
we minimize the total electronic energy functional
until we reach an energy minimum:

$$ E_{min} = \underset{n}{\min} \ E[n] , $$

which serves as our best estimate for the ground state
one-electron density $\rho_0(\bm{r})$.
\par
Levy and Lieb proposed to redefine the universal density functional
in terms of normalized antisymmetric wavefunctions $\Psi$
which yield a fixed density $\rho$:

$$ F[n] = \underset{\min}{\Psi \rightarrow \rho}
    \braket{\Psi | \hat{F} | \Psi}
    = \braket{\Psi[n] | \hat{F} | \Psi[n]} , $$

wherein the minima search is performed over wavefunctions
which yield the fixed density $\rho$.
A search is then performed over densitities $\rho$
until we reach an energy minimum. This method
is known as the \textit{constrained search formulation}.
However, we still do not have an explicit expression
for the universal density functional $F[n]$, and
direct approximations have proved difficult.
\par
Kohn and Sham proposed to decompose $F[n]$ as

$$ F[n] = T_s[n] + E_{Hxc}[n] , $$

where $T_s[n]$ is a non-interacting kinetic-energy functional
which can be defined through the constrained-search formulation:

$$ T_s[n] = \underset{\Phi \rightarrow n}{\min}
    \braket{\Phi | \hat{T} | \Phi}
    = \braket{\Phi[n] | \hat{T} | \Phi[n]} , $$

wherein the minima search is now performed over normalized
single-determinant wavefunctions $\Phi$ which yield
the fixed density $\rho$. The functional
$E_{Hxc}[n]$ is known as the Hartree-exchange-correlation
functional. The variational procedure is then
performed over single-determinant wavefunctions
which yield a fixed density $\rho$ and then
minimized over densities:

\begin{equation}
    \begin{split}
        E_0
        &= \underset{n}{\min} \set{
            F[n] + \int \hat{V}_{ne} n(\bm{r}) d\bm{r} } \\
        &= \underset{n}{\min} \
            \underset{\Phi \rightarrow n}{\min} \set{
            \braket{\Phi | \hat{T} + \hat{V}_{ne} | \Phi}
            + E_{Hxc}[n_{\Phi}]} \\
        &=  \underset{\Phi}{\min}
            \set{ \braket{\Psi|\hat{T} + \hat{V}_{ne}|\Phi}
            + E_{Hxc}[n_{\Phi}]} .
    \end{split}
\end{equation}

As with the Hartree-Fock method, the single determinant
wavefunctions are constructed from an orthonormal basis of spin orbitals
$\chi_i (\bm{x}), \ i=1,\dots,N$ with $\bm{x} = (\bm{r}, \sigma)$.
The total electronic energy can be expressed in terms of spatial
orbitals $\phi_i(\bm{r})$ after integrating over the spin variables:

\begin{equation}
    E = \sum_i \int \phi_i^* (\bm{r}) (-\frac{1}{2} \nabla^2 + \hat{v}_{ne})
        \phi_i(\bm{r}) d\bm{r} + E_{Hxc}[n] ,
\end{equation}

with the density expressed as

\begin{equation}
    n(\bm{r}) = \sum_i \left| \phi_i(\bm{r}) \right|^2 .
\end{equation}

With the constraint that the spatial orbitals be normalized
we obtain the following Lagrangian:

$$ \mathcal{L} [\set{\phi_i}]
    = E[\set{\phi_i}] - \sum_i \epsilon_i
    \left( \int \phi_i^* (\bm{r}) \phi_i(\bm{r}) d\bm{r} - 1 \right) , $$

with $\epsilon_i$ the associated Lagrangian multiplier.
We find the energy minimum where the Lagrangian is stationary:

$$ \frac{\partial \mathcal{L}}{\partial \phi_i^* (\bm{r})} = 0 . $$

The spatial orbitals are expanded as a linear combination
of a known basis, such as hydrogen-like functions
or Gaussian-type orbitals:

$$ \phi_i(\bm{r}) = \sum_{\lambda} C_{\lambda i} \chi_i (\bm{r}) . $$
